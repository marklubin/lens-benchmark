lens Loading dataset from datasets/scope_01_with_distractors.json
lens Starting run a88e1904a6c8 adapter=hindsight budget=constrained-8k
lens Scope cascading_failure_01: 120 episodes
lens   Checkpoint 18 for cascading_failure_01
lens     Answering 2 questions with 2 workers
lens     Question: cf01_q09_longitudinal
lens     Question: cf01_q10_evidence
lens   Checkpoint 38 for cascading_failure_01
Traceback (most recent call last):
  File "/home/mark/lens-benchmark/src/lens/adapters/hindsight.py", line 177, in prepare
    client.retain(
  File "/home/mark/lens-benchmark/.venv/lib/python3.12/site-packages/hindsight_client/hindsight_client.py", line 143, in retain
    return self.retain_batch(
           ^^^^^^^^^^^^^^^^^^
  File "/home/mark/lens-benchmark/.venv/lib/python3.12/site-packages/hindsight_client/hindsight_client.py", line 205, in retain_batch
    return _run_async(self._memory_api.retain_memories(bank_id, request_obj, _request_timeout=self._timeout))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mark/lens-benchmark/.venv/lib/python3.12/site-packages/hindsight_client/hindsight_client.py", line 39, in _run_async
    return loop.run_until_complete(coro)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mark/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/mark/lens-benchmark/.venv/lib/python3.12/site-packages/pydantic/_internal/_validate_call.py", line 34, in wrapper_function
    return await wrapper(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mark/lens-benchmark/.venv/lib/python3.12/site-packages/hindsight_client_api/api/memory_api.py", line 2308, in retain_memories
    return self.api_client.response_deserialize(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mark/lens-benchmark/.venv/lib/python3.12/site-packages/hindsight_client_api/api_client.py", line 325, in response_deserialize
    raise ApiException.from_response(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mark/lens-benchmark/.venv/lib/python3.12/site-packages/hindsight_client_api/exceptions.py", line 154, in from_response
    raise ServiceException(http_resp=http_resp, body=body, data=data)
hindsight_client_api.exceptions.ServiceException: (500)
Reason: Internal Server Error
HTTP response headers: <CIMultiDictProxy('Date': 'Mon, 23 Feb 2026 10:02:26 GMT', 'Server': 'uvicorn', 'Content-Length': '221', 'Content-Type': 'application/json')>
HTTP response body: {"detail":"Failed to generate batch embeddings: Error code: 413 - {'id': 'oYWXX33-4msxKE-9d25e5bf6e56c782', 'error': {'message': 'Request entity too large', 'type': 'invalid_request_error', 'param': None, 'code': None}}"}


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/mark/lens-benchmark/.venv/bin/lens", line 10, in <module>
    sys.exit(cli())
             ^^^^^
  File "/home/mark/lens-benchmark/.venv/lib/python3.12/site-packages/click/core.py", line 1485, in __call__
    return self.main(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mark/lens-benchmark/.venv/lib/python3.12/site-packages/click/core.py", line 1406, in main
    rv = self.invoke(ctx)
         ^^^^^^^^^^^^^^^^
  File "/home/mark/lens-benchmark/.venv/lib/python3.12/site-packages/click/core.py", line 1873, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mark/lens-benchmark/.venv/lib/python3.12/site-packages/click/core.py", line 1269, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mark/lens-benchmark/.venv/lib/python3.12/site-packages/click/core.py", line 824, in invoke
    return callback(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mark/lens-benchmark/src/lens/cli/run_commands.py", line 99, in run
    result = engine.run(episodes, questions=questions)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mark/lens-benchmark/src/lens/runner/runner.py", line 113, in run
    result = self._run_scope(adapter, scope_id, episodes, scope_questions)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mark/lens-benchmark/src/lens/runner/runner.py", line 213, in _run_scope
    checkpoint_result = self._run_checkpoint(
                        ^^^^^^^^^^^^^^^^^^^^^
  File "/home/mark/lens-benchmark/src/lens/runner/runner.py", line 263, in _run_checkpoint
    adapter.prepare(scope_id, checkpoint)
  File "/home/mark/lens-benchmark/src/lens/adapters/hindsight.py", line 184, in prepare
    raise AdapterError(
lens.core.errors.AdapterError: Failed to retain episode 'cascading_failure_01_dx_020' at checkpoint 38: (500)
Reason: Internal Server Error
HTTP response headers: <CIMultiDictProxy('Date': 'Mon, 23 Feb 2026 10:02:26 GMT', 'Server': 'uvicorn', 'Content-Length': '221', 'Content-Type': 'application/json')>
HTTP response body: {"detail":"Failed to generate batch embeddings: Error code: 413 - {'id': 'oYWXX33-4msxKE-9d25e5bf6e56c782', 'error': {'message': 'Request entity too large', 'type': 'invalid_request_error', 'param': None, 'code': None}}"}

Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7486419fe0c0>
Unclosed connector
connections: ['deque([(<aiohttp.client_proto.ResponseHandler object at 0x748641804a70>, 726735.678083744)])']
connector: <aiohttp.connector.TCPConnector object at 0x7486419fd7f0>
