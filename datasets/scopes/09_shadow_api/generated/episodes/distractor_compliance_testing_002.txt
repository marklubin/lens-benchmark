================================================================================
VANTAGE COMMERCE — COMPLIANCE & SECURITY TESTING LOG
Date: 2025-09-18
Classification: INTERNAL
================================================================================

────────────────────────────────────────────────────────────────────────────────
DOCUMENT 1: SOX IT General Controls (ITGC) — Q3 2025 Walkthrough Results
────────────────────────────────────────────────────────────────────────────────

Title: SOX IT General Controls (ITGC) — Q3 2025 Walkthrough Results
Reviewer: Nathan Osei (Internal Audit)
Control Owner: DevOps Engineering
Period: 2025-07-01 through 2025-09-15
Framework: COSO 2013 / COBIT 2019 mapping
Walkthrough conducted: 2025-09-16 via screenshare with Carla Mendes (DevOps Manager)
Evidence artifacts stored in audit vault ref: AV-2025-Q3-ITGC-047

--- ITGC-CM-01: Change Management ---

Control objective: All production changes are authorized, tested, and documented prior to deployment.

Sample: 25 production deployments from July through September 2025 selected for testing.

Results:
  Pre-approved change requests: 22/25 (88%)
  Emergency changes with retroactive approval: 3/25 (12%)
  Retroactive approval within 48-hour SLA: 3/3 (100%)
  No exceptions noted.

ITGC-CM-01 (Change Management): 22/25 deployments (88%) had pre-approved change requests. 3 emergency changes followed break-glass procedure with retroactive approval within SLA. No exceptions noted.

Emergency change tickets:
  1. CHG-2025-4891
     Date: 2025-07-22
     Service: checkout-service v2.17.1-hotfix
     Reason: Critical bug — double-charge on retry after gateway timeout
     Approved retroactively by: Carla Mendes (2025-07-22 14:30 UTC, within 6 hours)
     ServiceNow state: Closed — Implemented
     Change risk: HIGH
     Rollback plan: Revert to v2.17.0
     Post-implementation review: Completed 2025-07-23
     Impact: 47 duplicate charges detected and refunded within 4 hours
     Notification: Customer Support team alerted, affected customers received apology email

  2. CHG-2025-5012
     Date: 2025-08-09
     Service: svc-inventory-service v5.3.0-hotfix
     Reason: Inventory count sync failure causing overselling on 3 SKUs
     Approved retroactively by: Carla Mendes (2025-08-10 09:00 UTC, within 18 hours)
     ServiceNow state: Closed — Implemented
     Change risk: MEDIUM
     Rollback plan: Manual inventory adjustment + revert to v5.2.9
     Post-implementation review: Completed 2025-08-12
     Impact: 12 orders with inventory shortage — fulfillment team manually sourced replacements

  3. CHG-2025-5198
     Date: 2025-09-03
     Service: svc-shipping-calculator v2.8.9-hotfix
     Reason: Shipping cost calculation error for international orders (incorrect duty rate table)
     Approved retroactively by: Carla Mendes (2025-09-04 10:15 UTC, within 22 hours)
     ServiceNow state: Closed — Implemented
     Change risk: MEDIUM
     Rollback plan: Revert to v2.8.8 + manual shipping cost override
     Post-implementation review: Completed 2025-09-05
     Impact: 234 international orders with incorrect shipping costs — credits applied

Sample deployments included (non-emergency):
  1. svc-inventory-service v5.3.1 — deployed 2025-07-14
     CHG: CHG-2025-4712 (pre-approved)
     Approver: Carla Mendes
     CI build: Jenkins #inventory-5.3.1-4712
     Test pass rate: 100% (847/847 unit tests, 124/124 integration tests)
     Deploy method: ArgoCD auto-sync
     Health check: passed at 2025-07-14 14:22 UTC

  2. svc-shipping-calculator v2.9.0 — deployed 2025-08-02
     CHG: CHG-2025-4823 (pre-approved)
     Approver: Carla Mendes
     CI build: Jenkins #shipping-2.9.0-4823
     Test pass rate: 100% (592/592 unit tests, 87/87 integration tests)
     Deploy method: ArgoCD auto-sync
     Health check: passed at 2025-08-02 10:15 UTC

  3. checkout-service v2.17.0 — deployed 2025-08-19
     CHG: CHG-2025-4956 (pre-approved)
     Approver: Carla Mendes
     CI build: Jenkins #checkout-2.17.0-4956
     Test pass rate: 100% (1,203/1,203 unit tests, 256/256 integration tests)
     Deploy method: ArgoCD auto-sync with canary (10% traffic for 30 min)
     Health check: passed at 2025-08-19 16:45 UTC

  Plus 19 additional deployments — all with pre-approved change requests, all traced from GitLab merge to Jenkins build to Kubernetes deployment manifest. Full chain of custody verified.

--- Deployment Chain of Custody Verification ---

All 25 deployments verified with complete chain of custody:

Chain of custody steps:
  Step 1: Developer creates merge request in GitLab (git.vantage-internal.com)
  Step 2: Merge request reviewed and approved by 2 reviewers (branch protection enforced)
  Step 3: CI pipeline runs in Jenkins (build-cluster-prod)
  Step 4: All automated tests pass (unit, integration, security scan)
  Step 5: Artifact published to container registry (vcr.io)
  Step 6: Kubernetes deployment manifest updated with new image tag
  Step 7: ArgoCD detects manifest change and deploys to target environment
  Step 8: Deployment verified via health checks and smoke tests
  Step 9: ServiceNow change request updated to "Implemented" status

Evidence collected for all 25 samples:
  - GitLab merge request URL and approval timestamps
  - Jenkins build log with commit SHA and test results
  - Container image SHA256 digest matching between build and deploy
  - Kubernetes deployment event from kubectl get events
  - ServiceNow change request state transition log
  - ArgoCD sync status and health check result

--- ITGC-AC-03: Access Controls ---

ITGC-AC-03 (Access Controls): Jenkins admin roster reviewed. 8 admins. Cross-referenced with HR active employee list — all current. Last access review: 2025-08-01. Frequency: quarterly.

Jenkins admin role details (build-cluster-prod):
  Total users with admin access: 8

  User 1: carla.mendes@vantage.com — DevOps Manager — role justification: pipeline management, plugin admin
  User 2: tom.nguyen@vantage.com — Senior DevOps Engineer — role justification: pipeline configuration, agent management
  User 3: sara.johnson@vantage.com — DevOps Engineer — role justification: pipeline troubleshooting, credential management
  User 4: mike.chen@vantage.com — DevOps Engineer — role justification: pipeline configuration
  User 5: rachel.kim@vantage.com — Platform Engineer — role justification: Jenkins-Kubernetes integration
  User 6: david.okafor@vantage.com — Platform Engineer — role justification: Jenkins-GitLab integration
  User 7: anna.petrov@vantage.com — SRE Lead — role justification: incident response, pipeline recovery
  User 8: james.wu@vantage.com — SRE — role justification: incident response, agent scaling

  All 8 users cross-referenced with HR active employee list exported 2025-09-15.
  All 8 confirmed active employees with documented role justification.
  No stale accounts found.
  Previous access review (Q2): 7 admins — 1 added (james.wu, hired 2025-07-14)

Jenkins pipeline audit log retention: 180 days.
  SOX requirement: 90 days minimum.
  Compliance: PASS (180 > 90).
  Oldest available build log: Jenkins #checkout-2.15.0-3891 from 2025-03-22.

--- ITGC-SD-02: Segregation of Duties ---

ITGC-SD-02 (Segregation of Duties): GitLab merge approval and Jenkins deployment trigger require different user principals. Tested with 5 sample deployments — confirmed no single-user execution.

Segregation of duties configuration:

GitLab (git.vantage-internal.com):
  Branch protection on main branch (all 12 production repositories):
    - Minimum approvals required: 2
    - Code owner approval required: Yes
    - CI checks must pass before merge: Yes
    - Force push: Disabled
    - Delete branch: Disabled (for main)
    - Self-approval: Disabled (author cannot approve own MR)

  Evidence: GitLab project settings export for 12 production repositories
  All 12 enforce required approvals. Zero exceptions.
  Export date: 2025-09-16
  Evidence ref: AV-2025-Q3-ITGC-047-gitlab-settings

  Repository list with branch protection verified:
    1. platform/checkout-service ✓
    2. platform/payment-gateway ✓
    3. platform/order-management-service ✓
    4. platform/api-gateway ✓
    5. platform/auth-service ✓
    6. platform/user-profile-service ✓
    7. platform/search-service ✓
    8. platform/svc-inventory-service ✓
    9. platform/svc-shipping-calculator ✓
    10. platform/svc-notification-service ✓
    11. platform/svc-recommendation-engine ✓
    12. platform/svc-catalog-search ✓

Jenkins (build-cluster-prod):
  Deployment trigger: Only ArgoCD service account can trigger production deployments
  Manual override: Requires SRE-lead role (2 users: anna.petrov, rachel.kim)
  Separation verified: No GitLab merge approver has ArgoCD admin role
  ArgoCD service account: argocd-deployer-prod (service account, not human user)

Tested samples (SoD verification):
  Sample 1: svc-inventory-service v5.3.1
    MR author: alex.rivera
    MR approvers: tom.nguyen, sara.johnson
    Deploy trigger: argocd-deployer-prod (automated)
    Overlap between author/approvers and deployer: None ✓

  Sample 2: svc-shipping-calculator v2.9.0
    MR author: maria.gonzalez
    MR approvers: carla.mendes, mike.chen
    Deploy trigger: argocd-deployer-prod (automated)
    Overlap: None ✓

  Sample 3: checkout-service v2.17.0
    MR author: tom.nguyen
    MR approvers: david.okafor, sara.johnson
    Deploy trigger: argocd-deployer-prod (automated)
    Overlap: None ✓

  Sample 4: payment-gateway v4.7.0
    MR author: mike.chen
    MR approvers: rachel.kim, sara.johnson
    Deploy trigger: argocd-deployer-prod (automated)
    Overlap: None ✓

  Sample 5: order-management-service v3.11.2
    MR author: sara.johnson
    MR approvers: mike.chen, james.wu
    Deploy trigger: argocd-deployer-prod (automated)
    Overlap: None ✓

Walkthrough details:
  Conducted via screenshare with Carla Mendes on 2025-09-16 from 10:00 to 11:30 UTC.
  Carla demonstrated branch protection settings live in GitLab admin console.
  Nathan Osei captured screenshots and recorded session (with consent).
  Evidence artifacts stored in audit vault ref AV-2025-Q3-ITGC-047.

────────────────────────────────────────────────────────────────────────────────
DOCUMENT 2: Annual Security Awareness Training — Completion Report
────────────────────────────────────────────────────────────────────────────────

Title: Annual Security Awareness Training — Completion Report
Training Platform: KnowBe4
Campaign: VC-SAT-2025-Annual
Campaign Launch: 2025-08-15
Deadline: 2025-09-30
Coordinator: Priya Shankar (People Operations)
Content Reviewer: Marcus Tran (Security Lead)

--- Completion Status (as of 2025-09-18) ---

Total employees: 248
Completed: 198 (79.8%)
Outstanding: 50

Previous year completion rate at same point in campaign: 71.2%.
Current rate: 79.8% — improvement over previous year.

Department breakdown:

  Engineering (142 employees):
    Completed: 118 (83.1%)
    Outstanding: 24
      On PTO: 12
      Not started: 12
    Top team completion: Backend Engineering (96.2%, 25/26)
    Lowest team completion: Data Engineering (68.8%, 11/16)

  Customer Support (67 employees):
    Completed: 52 (77.6%)
    Outstanding: 15
      On PTO: 4
      Not started: 8
      In progress: 3

  Finance (31 employees):
    Completed: 28 (90.3%)
    Outstanding: 3
      In progress: 2
      Not started: 1

  Executive team (8 members):
    Completed: 8 (100%)
    All completed between 2025-08-15 and 2025-08-22

Priya Shankar sent reminder emails to 50 outstanding employees with manager CC on 2025-09-18.
Reminder: All employees must complete security awareness training by September 30, 2025. Non-completion will be escalated to department heads per policy VC-SEC-POL-004.

--- Training Modules ---

Total modules: 5
Total duration: 45 minutes
Languages available: English, Spanish

Module 1: Social Engineering Awareness (12 min)
  Topics: Phishing, vishing, smishing, pretexting, tailgating
  Average score: 87%
  Question count: 8
  Lowest question score: "Identify the social engineering technique in scenario 3" (72%)
  Highest question score: "Which of the following is a phishing red flag?" (96%)

Module 2: Password & Credential Hygiene (8 min)
  Topics: Password complexity, password managers, credential sharing prohibition, MFA enrollment
  Average score: 91%
  Question count: 6
  Highest scoring module across all departments
  Improvement from 2024: +4 percentage points (was 87%)

Module 3: Data Handling & Classification (10 min)
  Topics: Data classification levels (Public, Internal, Confidential, Restricted), handling procedures, disposal, GDPR basics
  Average score: 84%
  Question count: 7
  Lowest average module — flagged for content review by Marcus Tran
  Common mistake: Confusion between "Confidential" and "Restricted" classification levels

Module 4: Incident Reporting Procedures (8 min)
  Topics: What to report, how to report (Slack #security-incidents, PagerDuty, email), escalation timelines
  Average score: 89%
  Question count: 5
  Key takeaway: 94% correctly identified 24-hour reporting SLA for suspected data breaches

Module 5: Physical Security (7 min)
  Topics: Badge access, visitor procedures, clean desk policy, device locking, USB device policy
  Average score: 82%
  Question count: 5
  Second lowest module — many remote employees found it less relevant
  Note from Priya: Considering separate module tracks for remote vs on-site employees for 2026

Training Module Scores (avg): Social Engineering Awareness: 87%. Password & Credential Hygiene: 91%. Data Handling & Classification: 84%. Incident Reporting Procedures: 89%. Physical Security: 82%.

Completion certificate auto-generated and stored in HR system (BambooHR) for SOC 2 CC1.4 evidence.
Certificate format: PDF with employee name, completion date, score summary, digital signature, and unique certificate ID.

--- Phishing Simulation ---

Campaign: VC-PHISH-2025-09
Sent date: 2025-09-05
Template: Fake IT password reset email
Sender display: "IT Support <it-helpdesk@vantage-support.com>" (simulated external domain)
Subject: "Action Required: Password Expiring in 24 Hours"
Landing page: Simulated login page mimicking Okta SSO portal
Landing page URL: https://vantage-sso-update.phishtest.com/login

Results:
  Sent: 248
  Opened: 201 (81.0%)
  Clicked link: 14 (5.6%)
  Submitted credentials: 2 (0.8%)
  Reported as phishing via Slack or KnowBe4 button: 124 (50.0%)
  No action: 47 (19.0%)

Phishing Sim Results: Campaign 'VC-PHISH-2025-09'. Template: fake IT password reset. Sent: 248. Opened: 201 (81.0%). Clicked link: 14 (5.6%). Submitted credentials: 2 (0.8%). Reported as phishing: 124 (50.0%).

Year-over-year click rate trend:
  2023 annual: 11.4% click rate
  2024 annual: 8.2% click rate
  2025 Sep: 5.6% click rate
  Trajectory: steadily declining, target for 2026 is <4%

Breakdown of 14 users who clicked:
  Engineering: 6 (4.2% of 142)
  Customer Support: 5 (7.5% of 67)
  Finance: 2 (6.5% of 31)
  Executive: 1 (12.5% of 8)

2 employees who submitted credentials:
  Employee 1: Customer Support department
    Username entered: jennifer.martinez@vantage.com
    Assigned mandatory 1-on-1 coaching session with security team
    Session scheduled: 2025-09-25 14:00 UTC
    Manager notified: yes

  Employee 2: Engineering department (Data Engineering team)
    Username entered: kevin.zhao@vantage.com
    Assigned mandatory 1-on-1 coaching session with security team
    Session scheduled: 2025-09-26 10:00 UTC
    Manager notified: yes

  Both sessions conducted by Marcus Tran or designee.
  Coaching session includes: review of phishing indicators, hands-on phishing identification exercise, review of reporting procedure, follow-up phishing test within 30 days.

--- Content Review ---

Marcus Tran reviewed training content for accuracy prior to campaign launch:
  Modules reviewed: 2025-08-10 through 2025-08-13
  Changes approved:
    - Updated social engineering module with AI-generated phishing examples (deepfake voice, AI-written emails)
    - Updated credential hygiene module to reference Okta MFA enrollment process
    - Added GDPR data handling section to Module 3 per Elena Marchetti request
    - Updated incident reporting to include new Slack channel #security-incidents (replaced email-only reporting)
  Sign-off: Marcus Tran, 2025-08-13

--- Administrative ---

KnowBe4 license details:
  License type: KnowBe4 Diamond — up to 300 users
  Current utilization: 248/300 (82.7%)
  Annual cost: $18,400
  Current license expires: 2025-11-30
  Priya Shankar requested budget approval for 2026 renewal on 2025-09-15
  Budget approval status: Pending VP Engineering (Diana Flores) review
  Expected approval: 2025-10-01

────────────────────────────────────────────────────────────────────────────────
DOCUMENT 3: Grafana Alert Summary — Compliance Monitoring Dashboard
────────────────────────────────────────────────────────────────────────────────

Dashboard: Compliance Monitoring — SLA & Control Health
Date: 2025-09-18
Owner: compliance-ops team
URL: https://grafana.internal.vantage.com/d/compliance-sla-2025
Dashboard refresh interval: 15 minutes
Data sources: Prometheus, Qualys API, compliance-evidence-collector v2.1.3, patch-management-service v1.4.0

--- Overall Control Health ---

Total compliance controls monitored: 251

GREEN (passing): 236 (94.0%)
YELLOW (requires attention): 14 (5.6%)
RED (critical): 1 (0.4%)

Dashboard shows 94.2% of compliance controls in GREEN status (passing).

--- YELLOW Alerts (Detail) ---

ALERT [YELLOW] compliance/patch-sla
  Alert ID: COMP-ALERT-2025-09-18-001
  Severity: WARNING
  Fired: 2025-09-18 06:00 UTC
  Services affected:
    1. svc-catalog-search — patch CVE-2025-31247 overdue by 4 days
       CVE severity: MEDIUM (CVSS 5.8)
       Patch available since: 2025-09-10
       SLA for MEDIUM: 7 days
       SLA deadline: 2025-09-17
       Current status: overdue by 1 day (YELLOW threshold)
       Owner: platform-team
       Escalation at 7 days overdue (2025-09-21)
       Ticket: PATCH-2025-4821
       Description: Node.js prototype pollution in json-parse-better-errors dependency

    2. svc-email-notifier — patch CVE-2025-29881 overdue by 4 days
       CVE severity: MEDIUM (CVSS 6.1)
       Patch available since: 2025-09-10
       SLA for MEDIUM: 7 days
       SLA deadline: 2025-09-17
       Current status: overdue by 1 day (YELLOW threshold)
       Owner: platform-team
       Escalation at 7 days overdue (2025-09-21)
       Ticket: PATCH-2025-4822
       Description: ReDoS vulnerability in email-validator library

ALERT [YELLOW] compliance/evidence-collection
  Alert ID: COMP-ALERT-2025-09-18-002
  Severity: WARNING
  Fired: 2025-09-17 18:15 UTC
  Description: MFA enforcement report pull from IdP returned HTTP 503. Retry scheduled. Evidence gap: 2025-09-17 to present.
  Source: compliance-evidence-collector v2.1.3
  IdP: Okta
  Endpoint: https://vantage.okta.com/api/v1/reports/mfa-enrollment
  HTTP response: 503 Service Unavailable
  Retry schedule: every 4 hours
  Next retry: 2025-09-18 22:15 UTC
  Automated evidence collection ran 12 times this week — 11 successful, 1 failure (this MFA report pull)

--- RED Alert ---

ALERT [RED] compliance/vuln-scan
  Alert ID: COMP-ALERT-2025-09-18-003
  Severity: CRITICAL
  Fired: 2025-09-16 00:00 UTC
  Description: svc-notification-service quarterly scan MISSED. Scanner cron failure 2025-09-15. Scan rescheduled 2025-09-19. Ref: VULN-SCAN-Q3-2025-NTF.
  Scanner: vulnerability-scanner-cron (Qualys scheduled scans)
  Expected scan date: 2025-09-15 02:00 UTC
  Cron failure details:
    Job: qualys-quarterly-scan-notification-svc
    Schedule: 0 2 15 */3 * (quarterly on 15th at 02:00 UTC)
    Failure: CronJob pod failed to start — ImagePullBackOff on qualys-scanner:v4.2.1
    Root cause: Container registry authentication token expired 2025-09-14 23:59 UTC
    Token type: vcr.io long-lived pull secret (90-day expiry)
    Fix applied: Registry token refreshed 2025-09-17 by Sara Johnson (DevOps)
    Scan rescheduled: 2025-09-19 02:00 UTC
  Compliance impact: PCI-DSS Requirement 11.2 — quarterly vulnerability scanning must complete before Q3 end (2025-09-30)

--- Patch Management Summary ---

patch-management-service v1.4.0 processed 147 CVE patches across 38 services in September.
Median patch time: 3.2 days.

CVE patches applied this month by severity:
  Critical: 4 patches (avg 1.1 days to apply)
    CVE-2025-32104 — checkout-service — patched in 0.8 days
    CVE-2025-32891 — payment-gateway — patched in 1.2 days
    CVE-2025-33012 — auth-service — patched in 1.0 days
    CVE-2025-33401 — api-gateway — patched in 1.4 days

  High: 18 patches (avg 2.4 days to apply)
    Range: 1.1 days to 4.2 days
    All within 5-day SLA

  Medium: 89 patches (avg 3.8 days to apply)
    Range: 1.0 days to 7.0 days
    SLA: 7 days
    2 overdue (see YELLOW alert above)

  Low: 36 patches (avg 5.1 days to apply)
    Range: 2.0 days to 14.0 days
    SLA: 14 days
    0 overdue

--- Evidence Collector Status ---

compliance-evidence-collector v2.1.3
  Evidence storage: S3 bucket vc-compliance-evidence-2025 with AES-256 encryption
  Collection frequency: daily at 06:00 UTC
  Collections this week: 12 runs
  Successful: 11
  Failed: 1 (MFA report pull from Okta — HTTP 503)

────────────────────────────────────────────────────────────────────────────────
APPENDIX A: HTTP Log Excerpts — Compliance Evidence Collector API Calls
────────────────────────────────────────────────────────────────────────────────

Source: compliance-evidence-collector application log
Date: 2025-09-18

--- Daily Collection Run Start ---

[2025-09-18 06:00:01.201 UTC] INFO evidence-collector starting daily collection run
  Run ID: EC-RUN-2025-09-18-001
  Scheduled: daily
  Evidence types to collect: [mfa_enrollment, patch_status, access_review, vuln_scan, cert_status, backup_verify, net_seg, key_rotation]

--- Patch Status Collection (SUCCESS) ---

[2025-09-18 06:00:02.104 UTC] REQUEST
  Method: GET
  URL: http://patch-management-service.internal:8080/api/v1/compliance/status
  Headers:
    Authorization: Bearer <svc-evidence-collector-token>
    X-Request-ID: ec-req-2025-09-18-00001
    Accept: application/json

[2025-09-18 06:00:02.342 UTC] RESPONSE
  Status: 200 OK
  Content-Type: application/json
  Content-Length: 12847
  X-Response-Time: 238ms
  Body (excerpt):
  {
    "report_date": "2025-09-18",
    "total_services": 38,
    "total_cves_tracked": 147,
    "patches_applied": 145,
    "patches_pending": 2,
    "patches_overdue": 2,
    "overdue_details": [
      {"service": "svc-catalog-search", "cve": "CVE-2025-31247", "severity": "MEDIUM", "days_overdue": 1},
      {"service": "svc-email-notifier", "cve": "CVE-2025-29881", "severity": "MEDIUM", "days_overdue": 1}
    ],
    "patch_sla_compliance_rate": 0.986
  }

[2025-09-18 06:00:02.501 UTC] INFO artifact uploaded to S3
  Key: compliance-evidence/2025/09/18/patch_status_2025-09-18.json
  Bucket: vc-compliance-evidence-2025
  Size: 12847 bytes
  ETag: "a3f8b2c1d4e5f6a7b8c9d0e1f2a3b4c5"

--- MFA Enrollment Report Collection (FAILED) ---

[2025-09-18 06:00:05.701 UTC] REQUEST
  Method: GET
  URL: https://vantage.okta.com/api/v1/reports/mfa-enrollment
  Headers:
    Authorization: SSWS <okta-api-token-redacted>
    X-Request-ID: ec-req-2025-09-18-00004
    Accept: application/json

[2025-09-18 06:00:06.892 UTC] RESPONSE
  Status: 503 Service Unavailable
  Content-Type: application/json
  Body:
  {
    "errorCode": "E0000069",
    "errorSummary": "Service temporarily unavailable. Please try again later.",
    "errorId": "oae7yZ3x9dK4PbQ5-8901"
  }

[2025-09-18 06:00:06.901 UTC] WARN MFA enrollment report pull failed — HTTP 503
  Retry attempt 1 of 3...

[2025-09-18 06:00:08.201 UTC] RESPONSE (retry 1)
  Status: 503 Service Unavailable

[2025-09-18 06:00:09.401 UTC] RESPONSE (retry 2)
  Status: 503 Service Unavailable

[2025-09-18 06:00:09.410 UTC] ERROR MFA enrollment report pull FAILED after 3 attempts
  Evidence type: mfa_enrollment
  Source: Okta
  Gap start: 2025-09-17 06:00 UTC
  Next retry: 2025-09-18 10:00 UTC (4-hour backoff)
  Alert sent to #compliance-ops Slack channel and Grafana

--- Certificate Status Collection (SUCCESS) ---

[2025-09-18 06:00:12.301 UTC] REQUEST
  Method: GET
  URL: http://cert-manager-api.internal:8080/api/v1/certificates/status
  Headers:
    Authorization: Bearer <svc-evidence-collector-token>
    X-Request-ID: ec-req-2025-09-18-00006

[2025-09-18 06:00:12.512 UTC] RESPONSE
  Status: 200 OK
  Content-Length: 8421
  Body (excerpt):
  {
    "total_certificates": 187,
    "valid_gt_30d": 184,
    "expiring_within_30d": 3,
    "expired": 0,
    "expiring_details": [
      {"cn": "*.payments.vantage.com", "expiry": "2025-10-14", "days_remaining": 26, "renewal_ticket": "CERT-2025-091"},
      {"cn": "api.vantage.com", "expiry": "2025-10-21", "days_remaining": 33, "renewal_ticket": "CERT-2025-092"},
      {"cn": "cdn-origin.vantage.com", "expiry": "2025-10-09", "days_remaining": 21, "renewal_ticket": "CERT-2025-093"}
    ]
  }

[2025-09-18 06:00:12.601 UTC] INFO artifact uploaded to S3
  Key: compliance-evidence/2025/09/18/cert_status_2025-09-18.json

--- Key Rotation Status Collection (SUCCESS) ---

[2025-09-18 06:00:15.101 UTC] REQUEST
  Method: GET
  URL: https://vault.internal.vantage.com:8200/v1/sys/key-status
  Headers:
    X-Vault-Token: <svc-evidence-collector-vault-token>
    X-Request-ID: ec-req-2025-09-18-00008

[2025-09-18 06:00:15.234 UTC] RESPONSE
  Status: 200 OK
  Body:
  {
    "keys": {
      "cde-data-encryption-key": {"version": 14, "last_rotated": "2025-08-28T03:00:00Z", "next_rotation": "2025-11-26T03:00:00Z"},
      "tokenization-master-key": {"version": 14, "last_rotated": "2025-08-28T03:00:02Z", "next_rotation": "2025-11-26T03:00:00Z"},
      "audit-log-signing-key": {"version": 4, "last_rotated": "2025-07-01T00:00:00Z", "next_rotation": "2025-12-28T00:00:00Z"}
    }
  }

--- Backup Verification Collection (SUCCESS) ---

[2025-09-18 06:00:18.401 UTC] REQUEST
  Method: GET
  URL: http://backup-service.internal:8080/api/v1/verification/latest
  Headers:
    Authorization: Bearer <svc-evidence-collector-token>
    X-Request-ID: ec-req-2025-09-18-00010

[2025-09-18 06:00:18.612 UTC] RESPONSE
  Status: 200 OK
  Body:
  {
    "last_daily_backup": "2025-09-18T02:00:00Z",
    "last_weekly_backup": "2025-09-15T04:00:00Z",
    "daily_backup_status": "SUCCESS",
    "weekly_backup_status": "SUCCESS",
    "backup_size_daily_gb": 124.7,
    "backup_size_weekly_gb": 891.2,
    "retention_days": 30,
    "restore_test_last": "2025-06-20T00:00:00Z",
    "restore_test_result": "PASS",
    "restore_test_rto_minutes": 47
  }

--- Run Summary ---

[2025-09-18 06:00:48.901 UTC] INFO daily collection run complete
  Run ID: EC-RUN-2025-09-18-001
  Duration: 47.7 seconds
  Evidence types collected: 7/8 (87.5%)
  Failed: 1 (mfa_enrollment — Okta HTTP 503)
  Total artifacts uploaded to S3: 7
  Total bytes uploaded: 87,432

────────────────────────────────────────────────────────────────────────────────
APPENDIX B: Deploy Manifest — vulnerability-scanner-cron (Fixed)
────────────────────────────────────────────────────────────────────────────────

# Manifest for the Qualys vulnerability scanner CronJob
# Fixed on 2025-09-17 after registry auth token expiry caused ImagePullBackOff
# Owner: compliance-ops team
# Ticket: OPS-2025-3891 (registry token refresh)

apiVersion: batch/v1
kind: CronJob
metadata:
  name: qualys-quarterly-scan-notification-svc
  namespace: compliance
  labels:
    app: vulnerability-scanner
    scan-type: quarterly
    target-service: svc-notification-service
  annotations:
    compliance.vantage.com/pci-req: "11.2"
    compliance.vantage.com/schedule: "quarterly"
    compliance.vantage.com/last-failure: "2025-09-15T02:00:00Z"
    compliance.vantage.com/fix-date: "2025-09-17"
    compliance.vantage.com/fix-ticket: "OPS-2025-3891"
spec:
  schedule: "0 2 19 9 *"
  concurrencyPolicy: Forbid
  failedJobsHistoryLimit: 5
  successfulJobsHistoryLimit: 3
  jobTemplate:
    spec:
      backoffLimit: 3
      activeDeadlineSeconds: 7200
      template:
        spec:
          serviceAccountName: qualys-scanner-sa
          imagePullSecrets:
            - name: vcr-registry-auth-refreshed
          containers:
            - name: qualys-scanner
              image: vcr.io/qualys-scanner:v4.2.1
              command: ["python3", "/app/scan.py"]
              args:
                - "--target=svc-notification-service"
                - "--scan-type=quarterly"
                - "--output-s3=s3://vc-compliance-evidence-2025/vuln-scans/"
                - "--qualys-api-url=https://qualysapi.qualys.com"
                - "--ref=VULN-SCAN-Q3-2025-NTF"
              env:
                - name: QUALYS_USERNAME
                  valueFrom:
                    secretKeyRef:
                      name: qualys-credentials
                      key: username
                - name: QUALYS_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: qualys-credentials
                      key: password
                - name: AWS_REGION
                  value: "us-east-1"
              resources:
                requests:
                  cpu: "500m"
                  memory: "1Gi"
                limits:
                  cpu: "2000m"
                  memory: "4Gi"
          restartPolicy: Never
          nodeSelector:
            node-pool: compliance-tools

────────────────────────────────────────────────────────────────────────────────
APPENDIX C: Runbook — Compliance Evidence Collector Failure Recovery
────────────────────────────────────────────────────────────────────────────────

Runbook: RB-COMP-001 — Evidence Collector API Failure Recovery
Author: Nathan Osei
Created: 2025-09-18
Last Updated: 2025-09-18
Trigger: compliance-evidence-collector reports collection failure for any evidence type

Symptoms:
  - Grafana alert [YELLOW] compliance/evidence-collection fires
  - Slack notification in #compliance-ops with failure details
  - Evidence gap visible in Grafana Compliance Monitoring dashboard

Diagnosis:
  Step 1: Check the evidence collector logs
    kubectl -n compliance logs -l app=compliance-evidence-collector --since=1h | grep ERROR
    Identify which evidence type failed and the HTTP status code returned.

  Step 2: Check if the upstream API is healthy
    For Okta: curl -s -o /dev/null -w "%{http_code}" https://vantage.okta.com/api/v1/org -H "Authorization: SSWS <token>"
    For Qualys: curl -s -o /dev/null -w "%{http_code}" https://qualysapi.qualys.com/api/2.0/fo/scan/ -u "<user>:<pass>"
    For internal services: curl -s -o /dev/null -w "%{http_code}" http://<service>.internal:8080/health

  Step 3: Check API rate limits
    Okta rate limit headers: X-Rate-Limit-Remaining, X-Rate-Limit-Reset
    If rate limited, wait until reset time and retry.

Recovery:
  Step 4: If upstream is healthy, manually trigger evidence collection
    kubectl -n compliance exec deploy/compliance-evidence-collector -- python3 /app/collect.py --type mfa_enrollment --force

  Step 5: Verify evidence artifact in S3
    aws s3 ls s3://vc-compliance-evidence-2025/compliance-evidence/2025/09/18/ | grep mfa_enrollment

  Step 6: Update Grafana dashboard
    Dashboard auto-refreshes every 15 minutes. If needed, manual refresh via dashboard reload button.

Escalation:
  If upstream API remains unavailable for >24 hours:
    - Notify compliance-ops team lead (Lena Vasquez)
    - Document evidence gap in audit tracker with timestamps
    - File support ticket with upstream vendor (Okta, Qualys, etc.)
    - If gap exceeds 72 hours, notify auditor (James Reiter at Thornton-Kiley) per communication protocol

────────────────────────────────────────────────────────────────────────────────
APPENDIX D: ServiceNow Change Request Samples — Emergency Changes
────────────────────────────────────────────────────────────────────────────────

The following ServiceNow change request records were sampled during the ITGC-CM-01 walkthrough. These represent the 3 emergency changes identified in the sample of 25 deployments.

--- CHG-2025-4891 ---

Change Number: CHG-2025-4891
Type: Emergency
State: Closed — Implemented
Priority: P1 — Critical
Risk: HIGH

Requested by: Tom Nguyen (DevOps)
Approved by: Carla Mendes (DevOps Manager)
Approval method: Retroactive (break-glass procedure)
Time from implementation to approval: 6 hours

Service affected: checkout-service
Version deployed: v2.17.1-hotfix
Previous version: v2.17.0

Description:
  Critical bug identified in production — checkout-service v2.17.0 double-charges customers
  when the payment gateway returns a timeout and the retry logic fires. Bug triggered by
  payment-gateway latency spike on 2025-07-22 between 08:00-09:30 UTC.

Timeline:
  2025-07-22 08:15 UTC — PagerDuty alert: checkout-service error rate spike (INC-2025-0722)
  2025-07-22 08:22 UTC — On-call engineer (Tom Nguyen) identified double-charge in payment logs
  2025-07-22 08:30 UTC — Hotfix branch created from v2.17.0 tag
  2025-07-22 08:45 UTC — Fix: Added idempotency key to payment retry logic
  2025-07-22 09:00 UTC — Peer review by Sara Johnson (expedited, single reviewer for emergency)
  2025-07-22 09:10 UTC — CI pipeline green (all 1,203 unit tests pass)
  2025-07-22 09:15 UTC — Deployed to production via ArgoCD manual sync
  2025-07-22 09:20 UTC — Verified: no new double-charges in payment logs
  2025-07-22 14:30 UTC — Carla Mendes retroactively approved CHG-2025-4891

Impact assessment:
  47 duplicate charges detected across 47 unique customers
  Total duplicate amount: $6,847.23
  All 47 refunds processed by 2025-07-22 12:00 UTC
  Customer Support sent apology emails to all affected customers

Post-implementation review:
  Completed: 2025-07-23
  Action items:
    1. Add idempotency key to all payment retry flows (not just checkout)
    2. Add alerting for duplicate payment detection
    3. Review payment-gateway timeout configuration (currently 10s, consider 15s)

Rollback plan: Revert to checkout-service v2.17.0 via ArgoCD

Audit evidence: AV-2025-Q3-ITGC-047-CHG4891

--- CHG-2025-5012 ---

Change Number: CHG-2025-5012
Type: Emergency
State: Closed — Implemented
Priority: P2 — High
Risk: MEDIUM

Requested by: Alex Rivera (Backend Engineering)
Approved by: Carla Mendes (DevOps Manager)
Approval method: Retroactive (break-glass procedure)
Time from implementation to approval: 18 hours

Service affected: svc-inventory-service
Version deployed: v5.3.0-hotfix
Previous version: v5.3.0

Description:
  Inventory count sync failure causing overselling on 3 SKUs. Root cause: race condition in
  the inventory decrement function when concurrent checkout requests target the same SKU.
  Bug introduced in v5.3.0 when the locking mechanism was refactored from pessimistic to
  optimistic locking without proper retry logic.

Timeline:
  2025-08-09 11:00 UTC — Customer Support escalation: customer received "out of stock" notification after successful order
  2025-08-09 11:30 UTC — Engineering investigation: 3 SKUs showing negative inventory counts
  2025-08-09 12:00 UTC — Root cause identified: optimistic lock retry missing
  2025-08-09 12:30 UTC — Hotfix branch created, added retry-on-conflict with exponential backoff
  2025-08-09 13:15 UTC — Peer review by Maria Gonzalez
  2025-08-09 13:25 UTC — CI pipeline green (847 unit tests, 124 integration tests)
  2025-08-09 13:30 UTC — Deployed to production
  2025-08-09 13:45 UTC — Inventory counts manually corrected for 3 affected SKUs
  2025-08-10 09:00 UTC — Carla Mendes retroactively approved CHG-2025-5012

Impact assessment:
  12 orders with inventory shortage
  3 SKUs affected: SKU-28471 (wireless earbuds), SKU-39582 (phone case), SKU-41093 (charger)
  Fulfillment team manually sourced replacement inventory from secondary warehouse
  All 12 orders fulfilled with 1-day delay

Post-implementation review: Completed 2025-08-12
Rollback plan: Manual inventory adjustment + revert to v5.2.9
Audit evidence: AV-2025-Q3-ITGC-047-CHG5012

--- CHG-2025-5198 ---

Change Number: CHG-2025-5198
Type: Emergency
State: Closed — Implemented
Priority: P2 — High
Risk: MEDIUM

Requested by: Maria Gonzalez (Backend Engineering)
Approved by: Carla Mendes (DevOps Manager)
Approval method: Retroactive (break-glass procedure)
Time from implementation to approval: 22 hours

Service affected: svc-shipping-calculator
Version deployed: v2.8.9-hotfix
Previous version: v2.8.9

Description:
  Shipping cost calculation error for international orders. The duty rate table was updated
  on 2025-09-01 but the CSV import script transposed two columns (duty_rate and tax_rate)
  for EU destinations. Result: EU orders showed approximately 40% higher shipping costs.

Timeline:
  2025-09-03 06:00 UTC — Customer complaint spike: 18 tickets about shipping costs for EU orders
  2025-09-03 07:30 UTC — Engineering confirmed duty rate table column transposition
  2025-09-03 08:00 UTC — Hotfix: corrected CSV import, reloaded duty rate table
  2025-09-03 08:15 UTC — Peer review by Kevin Zhao
  2025-09-03 08:25 UTC — CI pipeline green (592 unit tests, 87 integration tests)
  2025-09-03 08:30 UTC — Deployed to production
  2025-09-03 09:00 UTC — Verified: shipping cost calculation correct for sample EU orders
  2025-09-04 10:15 UTC — Carla Mendes retroactively approved CHG-2025-5198

Impact assessment:
  234 international orders with incorrect shipping costs (2025-09-01 through 2025-09-03)
  Average overcharge per order: $12.47
  Total credits applied: $2,917.98
  Customer Support notified all affected customers

Post-implementation review: Completed 2025-09-05
  Action items:
    1. Add column header validation to CSV import script
    2. Add automated regression test comparing calculated duty rates against known reference set
    3. Require two-person review for duty rate table updates

Rollback plan: Revert to v2.8.8 + manual shipping cost override
Audit evidence: AV-2025-Q3-ITGC-047-CHG5198

────────────────────────────────────────────────────────────────────────────────
APPENDIX E: Jenkins Admin Access Review Export
────────────────────────────────────────────────────────────────────────────────

Export date: 2025-09-15
Source: Jenkins (build-cluster-prod) → Manage Jenkins → Security → Authorization
Cross-referenced with: BambooHR active employee export 2025-09-15

User                          | Role        | Last Login          | Status   | Justification
------------------------------|-------------|---------------------|----------|---------------------------
carla.mendes@vantage.com      | admin       | 2025-09-15 09:14    | Active   | DevOps Manager
tom.nguyen@vantage.com        | admin       | 2025-09-14 16:42    | Active   | Sr DevOps Engineer
sara.johnson@vantage.com      | admin       | 2025-09-15 08:30    | Active   | DevOps Engineer
mike.chen@vantage.com         | admin       | 2025-09-13 11:20    | Active   | DevOps Engineer
rachel.kim@vantage.com        | admin       | 2025-09-15 10:05    | Active   | Platform Engineer
david.okafor@vantage.com      | admin       | 2025-09-12 14:55    | Active   | Platform Engineer
anna.petrov@vantage.com       | admin       | 2025-09-15 07:22    | Active   | SRE Lead
james.wu@vantage.com          | admin       | 2025-09-14 13:08    | Active   | SRE

Total admin users: 8
Terminated employees in admin list: 0
Role justification on file: 8/8 (100%)
Last access review: 2025-08-01 (quarterly)
Next scheduled access review: 2025-11-01

Non-admin users with pipeline access:
  build-user role: 47 users (developers with build-trigger permissions only)
  read-only role: 12 users (QA, audit, management with view-only access)
  service-account role: 3 accounts (argocd-deployer-prod, github-webhook-bot, sonarqube-scanner)

All non-admin users also cross-referenced with HR active employee list — no discrepancies found.

────────────────────────────────────────────────────────────────────────────────
APPENDIX F: GitLab Branch Protection Settings Export (Sample)
────────────────────────────────────────────────────────────────────────────────

The following settings were exported from GitLab (git.vantage-internal.com) during the ITGC-SD-02 walkthrough on 2025-09-16. Carla Mendes demonstrated these settings live during screenshare.

Repository: platform/checkout-service
Branch: main
Protected: Yes
Push access level: No one (all changes via merge request)
Merge access level: Maintainers
Approvals required: 2
Approval rules:
  Rule 1: "Code Owners" — at least 1 approval from CODEOWNERS file match
  Rule 2: "Security Review" — required for files matching security/* paths
Self-approval allowed: No
Force push allowed: No
Branch deletion allowed: No
Status checks required: Yes
  Required checks:
    - jenkins/unit-tests (must pass)
    - jenkins/integration-tests (must pass)
    - sonarqube/quality-gate (must pass)
    - snyk/security-scan (must pass)
Merge method: Merge commit (no fast-forward)
Squash commits: Optional (developer choice)

Repository: platform/payment-gateway
Branch: main
Protected: Yes
Push access level: No one
Merge access level: Maintainers
Approvals required: 2
Approval rules:
  Rule 1: "Code Owners" — at least 1 approval from CODEOWNERS
  Rule 2: "PCI Review" — required for all merge requests (CDE service)
Self-approval allowed: No
Force push allowed: No
Status checks required: Yes
  Required checks:
    - jenkins/unit-tests
    - jenkins/integration-tests
    - jenkins/pci-compliance-scan (additional check for CDE services)
    - sonarqube/quality-gate
    - snyk/security-scan

Repository: platform/order-management-service
Branch: main
Protected: Yes
Push access level: No one
Merge access level: Maintainers
Approvals required: 2
Approval rules:
  Rule 1: "Code Owners" — at least 1 approval from CODEOWNERS
Self-approval allowed: No
Force push allowed: No
Status checks required: Yes
  Required checks:
    - jenkins/unit-tests
    - jenkins/integration-tests
    - sonarqube/quality-gate
    - snyk/security-scan

Note: All 12 production repositories have equivalent branch protection settings. Payment-gateway and tokenization-service have the additional pci-compliance-scan check requirement due to their CDE classification.

Evidence exported as JSON and PDF screenshots, stored in audit vault ref AV-2025-Q3-ITGC-047-gitlab-settings.

────────────────────────────────────────────────────────────────────────────────
APPENDIX G: Phishing Simulation — Detailed Click Timeline
────────────────────────────────────────────────────────────────────────────────

Campaign: VC-PHISH-2025-09
Sent: 2025-09-05 09:00 UTC
Template: Fake IT password reset

Click timeline (14 users who clicked the link):

  2025-09-05 09:03 UTC — user: j.martinez@vantage.com (Customer Support) — opened email, clicked link
  2025-09-05 09:07 UTC — user: k.zhao@vantage.com (Engineering/Data) — opened email, clicked link, SUBMITTED CREDENTIALS
  2025-09-05 09:12 UTC — user: l.wong@vantage.com (Engineering/Frontend) — opened email, clicked link
  2025-09-05 09:18 UTC — user: p.garcia@vantage.com (Customer Support) — opened email, clicked link
  2025-09-05 09:25 UTC — user: s.kumar@vantage.com (Engineering/QA) — opened email, clicked link
  2025-09-05 09:31 UTC — user: d.thompson@vantage.com (Finance) — opened email, clicked link
  2025-09-05 09:44 UTC — user: r.chen@vantage.com (Customer Support) — opened email, clicked link
  2025-09-05 10:02 UTC — user: a.wilson@vantage.com (Engineering/Mobile) — opened email, clicked link
  2025-09-05 10:15 UTC — user: j.martinez@vantage.com (Customer Support) — SUBMITTED CREDENTIALS
  2025-09-05 10:28 UTC — user: m.davis@vantage.com (Executive/CTO) — opened email, clicked link
  2025-09-05 11:01 UTC — user: t.brown@vantage.com (Engineering/Backend) — opened email, clicked link
  2025-09-05 11:45 UTC — user: n.patel@vantage.com (Customer Support) — opened email, clicked link
  2025-09-05 13:22 UTC — user: c.lee@vantage.com (Finance) — opened email, clicked link
  2025-09-05 14:07 UTC — user: j.anderson@vantage.com (Engineering/DevOps) — opened email, clicked link

Report as phishing timeline (first 10 reporters):
  2025-09-05 09:02 UTC — user: m.tran@vantage.com (Security) — reported via KnowBe4 phish alert button
  2025-09-05 09:04 UTC — user: a.petrov@vantage.com (SRE) — reported via Slack #security-incidents
  2025-09-05 09:05 UTC — user: c.mendes@vantage.com (DevOps) — reported via KnowBe4 button
  2025-09-05 09:06 UTC — user: n.osei@vantage.com (Audit) — reported via KnowBe4 button
  2025-09-05 09:08 UTC — user: l.vasquez@vantage.com (Audit) — reported via KnowBe4 button
  2025-09-05 09:09 UTC — user: d.okafor@vantage.com (Platform) — reported via Slack
  2025-09-05 09:10 UTC — user: r.kim@vantage.com (Platform) — reported via KnowBe4 button
  2025-09-05 09:11 UTC — user: s.johnson@vantage.com (DevOps) — reported via KnowBe4 button
  2025-09-05 09:14 UTC — user: b.okoro@vantage.com (SRE) — reported via KnowBe4 button
  2025-09-05 09:17 UTC — user: k.johannsen@vantage.com (QA) — reported via KnowBe4 button

Total reporters within first 30 minutes: 42 out of 124 total reporters (33.9%)
Median time to report: 2 hours 14 minutes from email receipt

================================================================================
END OF DOCUMENT — 2025-09-18
================================================================================